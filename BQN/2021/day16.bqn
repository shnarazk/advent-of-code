Solve â‡ {envâ€¿part ğ•Š data :
  util â† â€¢Import "/util.bqn"âˆ¾Ëœ"." env.VarâŒ¾â‹ˆ "BQN_LIB"
  data "0123456789ABCDEF"âŠ¸âŠâŒ¾â‹ˆÂ¨âˆ˜âŠ‘ â†©
  len â† â‰ data (âˆ¾{âŒ½4â†‘8â€¿1â€¢bit._castâ‹ˆğ•©}Â¨) â†©
  Version â† 3âŠ¸â†‘
  TypeID â† 3âŠ¸â†‘3âŠ¸â†“
  ToNum â† {0{+âŸœ(2âŠ¸Ã—)}Â´âŒ½ğ•©}
  sum â† 0
  num_packets_stack â† âŸ¨0âŸ©
  value_stack â† âŸ¨âŸ¨âŸ©âŸ©
  Traverse â† {ğ•Š start :
    Â¬âˆ§Â´0=startâ†“data ?
    num_packets_stack (1âŠ¸+âŒ¾âŠ‘) â†©
    packet â† startâ†“data
    "# start" util.Debug startâ‹ˆ6â†‘packet
    sum + â†© version â† ToNum Version packet
    type â† ToNum TypeID packet
    {
      4=type ?
        blocks â† <Ë˜âŒ½â€¿5â¥Š6â†“packet
        len â† 1+(âŠ‘Â¨blocks)âŠ¸âŠâŒ¾â‹ˆ0
        payload â† ToNumâˆ¾1âŠ¸â†“Â¨lenâ†‘blocks
        value_stack (payloadâŠ¸âˆ¾âŒ¾âŠ‘) â†©
        start+6+5Ã—len
      ;
        num_packets_stack âŸ¨0âŸ©âŠ¸âˆ¾ â†©
        value_stack âŸ¨âŸ¨âŸ©âŸ©âŠ¸âˆ¾ â†©
        lengthTypeID â† 6âŠ‘packet
        length_indicator â† ToNum lengthTypeIDâ—¶âŸ¨15âŠ¸â†‘,11âŠ¸â†‘âŸ©7â†“packet
        r â† {
          0=lengthTypeID ?
            limit â† length_indicator+22+start
            Traverseâ€¢_while_(limitâŠ¸>)22+start
          ;
            Traverseâ€¢_while_{ğ•¤ â‹„ length_indicator>âŠ‘num_packets_stack}18+start
        }
        num_packets_stack 1âŠ¸â†“ â†©
        val â† typeâ—¶âŸ¨+Â´,Ã—Â´,âŒŠÂ´,âŒˆÂ´,âŠ¢,<Â´,>Â´,=Â´âŸ©âŠ‘value_stack
        value_stack (valâŠ¸âˆ¾âŒ¾âŠ‘1âŠ¸â†“) â†©
        r
    }
    ;
    S ğ•© : â‰ data
  }
  Traverseâ€¢_while_(lenâŠ¸>)0
  {1=part ? sum ; âŠ‘âŠ‘value_stack}
}
