Solve â‡ {envâ€¿part ğ•Š data :
  util â† â€¢Import "/util.bqn"âˆ¾Ëœ"." env.VarâŒ¾â‹ˆ "BQN_LIB"
  data util.ParseIntsâˆ˜âŠ‘ â†©
  {
    1=part ?
      2âŠ‘{indexâ€¿stackâ€¿sum:
        {
          âˆâ‰¡âŠ‘stack ?
            childâ€¿meta â† (0â€¿1+index)âŠdata
            âŸ¨index+2,(âˆÂ¨â†•child)âˆ¾âŸ¨metaâŸ©âˆ¾1â†“stack,sumâŸ©
          ;
            âŸ¨metaâŸ©â€¿tack â† 1(â†‘â‹ˆâ†“)stack
            âŸ¨index+meta,tack,sum++Â´(index+â†•meta)âŠdataâŸ©
        }
      }â€¢_while_(âŸ¨âŸ©â‰¢1âŠ¸âŠ‘)âŸ¨0,âŸ¨âˆâŸ©,0âŸ©
    ;
      +Â´2âŠ‘{indexâ€¿stackâ€¿sum:
        {
          âˆâ‰¡âŠ‘stack ?
            childâ€¿meta â† (0â€¿1+index)âŠdata
            # child and meta will be used AFTER traverse, so keep then in stack
            âŸ¨index+2,(âˆÂ¨â†•child)âˆ¾âŸ¨childâ€¿metaâŸ©âˆ¾1â†“stack,sumâŸ©
          ;
            âŸ¨childâ€¿metaâŸ©â€¿tack â† 1(â†‘â‹ˆâ†“)stack
            {
              0=child ?
                âŸ¨index+meta,tack,sumâˆ¾Ëœ+Â´(index+â†•meta)âŠdataâŸ©
              ;
                sâ€¿um â† child(â†‘â‹ˆâ†“)sum
                i â† ((â‰ s)âŠ¸>âˆ§(0âŠ¸â‰¤))Â¨âŠ¸/Â¯1+(index+â†•meta)âŠdata
                v â† +Â´iâŠâŒ½s
                âŸ¨index+meta,tack,vâˆ¾umâŸ©
            }
        }
      }â€¢_while_(âŸ¨âŸ©â‰¢1âŠ¸âŠ‘)âŸ¨0,âŸ¨âˆâŸ©,âŸ¨âŸ©âŸ©
  }
}
