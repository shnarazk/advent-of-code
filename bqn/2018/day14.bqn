Solve â‡ {envâ€¿part ğ•Š data :
  utilâ€¿âŸ¨refâŸ© â† â€¢ImportÂ¨"/util.bqn"â€¿"/ref.bqn"âˆ¾ËœÂ¨<"." env.VarâŒ¾â‹ˆ "BQN_LIB"
  data util.ParseIntâˆ˜âŠ‘ â†©
  record â† 3â€¿7
  pass_as_arg â† 1
  # pass_as_arg â† 1
    # nix$ time 2018 14 1
    #  âŸ Year 2018 Day 14 â†’ data/2018/input-day14.txt
    # Part1: âŸ¨ 1 1 5 0 5 1 1 3 8 2 âŸ©
    # 2018 14 1  198.73s user 0.28s system 99% cpu 3:19.20 total
  # pass_as_arg â† 0
    # nix$ time 2018 14 1
    #  âŸ Year 2018 Day 14 â†’ data/2018/input-day14.txt
    # Part1: âŸ¨ 1 1 5 0 5 1 1 3 8 2 âŸ©
    # 2018 14 1  0.47s user 0.02s system 98% cpu 0.492 total
  {
    pass_as_argâˆ§1=part ?
      util.Debug data
      # record â† Ref 3â€¿7
      # Process â† {ğ•Š indexes :
      #   (0=1000âŠ¸|)â—¶âŸ¨âŠ¢,util.ProgressâŸ©â‰ record.ref
      #   âˆ¾ record._apply util.Digits+Â´ current â† indexesâŠrecord.ref
      #   (â‰ record.ref)|indexes+1+current
      # }
      # Processâ€¢_while_{ğ•¤ â‹„ (10+data)>â‰ record.ref}0â€¿1
      # 10â†‘dataâ†“record.ref
      Process â† {indexesâ€¿record :
        (0=1000âŠ¸|)â—¶âŸ¨âŠ¢,util.ProgressâŸ©â‰ record.ref
        âˆ¾record._apply util.Digits+Â´ current â† indexesâŠrecord.ref
        âŸ¨(â‰ record.ref)|indexes+1+current,recordâŸ©
      }
      10â†‘dataâ†“{(1âŠ‘ğ•©).ref}Processâ€¢_while_{(10+data)>â‰ (1âŠ‘ğ•©).ref}âŸ¨0â€¿1,Ref 3â€¿7âŸ©
      # Process â† {indexesâ€¿record :
      #   (0=1000âŠ¸|)â—¶âŸ¨âŠ¢,util.ProgressâŸ©â‰ record
      #   dd â† util.Digits+Â´ current â† indexesâŠrecord
      #   record âˆ¾âŸœdd â†©
      #   âŸ¨(â‰ record)|indexes+1+current,recordâŸ©
      # }
      # 10â†‘dataâ†“1âŠ‘Processâ€¢_while_{(10+data)>â‰ 1âŠ‘ğ•©}âŸ¨0â€¿1,3â€¿7âŸ©
      ;
    pass_as_arg ?
      l â† 1+ k â† â‰  data util.Digits â†©
      d â† â‹ˆÂ¯1âŠ‘data
      !(âŠ‘d)â‰ Â¯2âŠ‘data
      Process â† {indexesâ€¿to_check :
        (0=10000âŠ¸|)â—¶âŸ¨âŠ¢,util.ProgressâŸ©â‰ record
        dd â† util.Digits+Â´ current â† indexesâŠrecord
        record âˆ¾âŸœdd â†©
        âŸ¨(â‰ record)|indexes+1+current,ddâˆŠdâŸ©
      }
      Shape â† {(â‰ record)-((1â€¿0âŠ¸â‰¢âˆ¨1â€¿1âŠ¸â‰¢)1âŠ‘ğ•©)â—¶âŸ¨âŠ¢,1âŠ¸+âŸ©k}
      Check â† {nâ€¿check :
        {
           0â€¿0 : 1 ;
           0â€¿1 : dataâ‰¢(-k)â†‘record ;
           1â€¿x : dataâ‰¢Â¯1â†“(-l)â†‘record ;
           âŸ¨0âŸ© : 1 ;
           âŸ¨1âŸ© : dataâ‰¢(-k)â†‘record
        }check
      }
      Shape Processâ€¢_while_ Check âŸ¨0â€¿1,âŸ¨0âŸ©âŸ©
      ;
    1=part ?
      Process â† {ğ•Š indexes :
        (0=1000âŠ¸|)â—¶âŸ¨âŠ¢,util.ProgressâŸ©â‰ record
        dd â† util.Digits+Â´ current â† indexesâŠrecord
        record âˆ¾âŸœdd â†©
        (â‰ record)|indexes+1+current
      }
      Processâ€¢_while_{ğ•¤ â‹„ (10+data)>â‰ record}0â€¿1
      10â†‘dataâ†“record
    ;
      l â† 1+ k â† â‰  data util.Digits â†©
      d â† â‹ˆÂ¯1âŠ‘data
      !(âŠ‘d)â‰ Â¯2âŠ‘data
      Process â† {indexesâ€¿to_check :
        (0=10000âŠ¸|)â—¶âŸ¨âŠ¢,util.ProgressâŸ©â‰ record
        dd â† util.Digits+Â´ current â† indexesâŠrecord
        record âˆ¾âŸœdd â†©
        âŸ¨(â‰ record)|indexes+1+current,ddâˆŠdâŸ©
      }
      Shape â† {(â‰ record)-((1â€¿0âŠ¸â‰¢âˆ¨1â€¿1âŠ¸â‰¢)1âŠ‘ğ•©)â—¶âŸ¨âŠ¢,1âŠ¸+âŸ©k}
      Check â† {nâ€¿check :
        {
           0â€¿0 : 1 ;
           0â€¿1 : dataâ‰¢(-k)â†‘record ;
           1â€¿x : dataâ‰¢Â¯1â†“(-l)â†‘record ;
           âŸ¨0âŸ© : 1 ;
           âŸ¨1âŸ© : dataâ‰¢(-k)â†‘record
        }check
      }
      Shape Processâ€¢_while_ Check âŸ¨0â€¿1,âŸ¨0âŸ©âŸ©
  }
}
