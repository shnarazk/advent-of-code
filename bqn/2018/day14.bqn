Solve â‡ {envâ€¿part ğ•Š data :
  utilâ€¿âŸ¨refâŸ© â† â€¢ImportÂ¨"/util.bqn"â€¿"/ref.bqn"âˆ¾ËœÂ¨<"." env.VarâŒ¾â‹ˆ "BQN_LIB"
  data util.ParseIntâˆ˜âŠ‘ â†©
  record â† 3â€¿7
  pass_as_arg â† 1    # is as fast as 0
  # pass_as_arg â† 2
    #  âŸ Year 2018 Day 14 â†’ data/2018/input-day14.txt
    # Part1: âŸ¨ 1 1 5 0 5 1 1 3 8 2 âŸ©
    # 2018 14 1  198.73s user 0.28s system 99% cpu 3:19.20 total
  # pass_as_arg â† 0
    #  âŸ Year 2018 Day 14 â†’ data/2018/input-day14.txt
    # Part1: âŸ¨ 1 1 5 0 5 1 1 3 8 2 âŸ©
    # 2018 14 1  0.47s user 0.02s system 98% cpu 0.492 total
  # Comparsion with Bup.Ref
  # pass_as_arg â† 0 (global var)
    # | day 14 |  60 |    0.284 |   11.385 |
  # pass_as_arg â† 1 (Bup.Ref)
    # | day 14 |  60 |    0.320 |   11.996 |
  {
    (0=pass_as_arg)âˆ§1=part ?
      Process â† {ğ•Š indexes :
        (0=1000âŠ¸|)â—¶âŸ¨âŠ¢,util.ProgressâŸ©â‰ record
        record âˆ¾ â†© util.Digits+Â´ current â† indexesâŠrecord
        (â‰ record)|indexes+1+current
      }
      Processâ€¢_while_{ğ•¤ â‹„ (10+data)>â‰ record}0â€¿1
      10â†‘dataâ†“record
      ;
    (1=pass_as_arg)âˆ§1=part ?
      Process â† {indexesâ€¿record :
        (0=1000âŠ¸|)â—¶âŸ¨âŠ¢,util.ProgressâŸ©â‰ record.ref
        âˆ¾record._apply util.Digits+Â´ current â† indexesâŠrecord.ref
        âŸ¨(â‰ record.ref)|indexes+1+current,recordâŸ©
      }
      10â†‘dataâ†“{(1âŠ‘ğ•©).ref}Processâ€¢_while_{(10+data)>â‰ (1âŠ‘ğ•©).ref}âŸ¨0â€¿1,Ref 3â€¿7âŸ©
      ;
    # (2=pass_as_arg)âˆ§1=part ?
    #   Process â† {indexesâ€¿record :
    #     (0=1000âŠ¸|)â—¶âŸ¨âŠ¢,util.ProgressâŸ©â‰ record
    #     dd â† util.Digits+Â´ current â† indexesâŠrecord
    #     record âˆ¾âŸœdd â†©
    #     âŸ¨(â‰ record)|indexes+1+current,recordâŸ©
    #   }
    #   10â†‘dataâ†“1âŠ‘Processâ€¢_while_{(10+data)>â‰ 1âŠ‘ğ•©}âŸ¨0â€¿1,3â€¿7âŸ©
    #   ;
    (0=pass_as_arg)âˆ§2=part ?
      l â† 1+ k â† â‰  data util.Digits â†©
      !(Â¯2âŠ‘data)â‰ âŠ‘ d â† â‹ˆÂ¯1âŠ‘data
      Process â† {indexesâ€¿to_check :
        (0=10000âŠ¸|)â—¶âŸ¨âŠ¢,util.ProgressâŸ©â‰ record
        dd â† util.Digits+Â´ current â† indexesâŠrecord
        record âˆ¾âŸœdd â†©
        âŸ¨(â‰ record)|indexes+1+current,ddâˆŠdâŸ©
      }
      Shape â† {(â‰ record)-((1â€¿0âŠ¸â‰¢âˆ¨1â€¿1âŠ¸â‰¢)1âŠ‘ğ•©)â—¶âŸ¨âŠ¢,1âŠ¸+âŸ©k}
      Check â† {
         0â€¿0 : 1 ;
         0â€¿1 : dataâ‰¢(-k)â†‘record ;
         1â€¿x : dataâ‰¢Â¯1â†“(-l)â†‘record ;
         âŸ¨0âŸ© : 1 ;
         âŸ¨1âŸ© : dataâ‰¢(-k)â†‘record
      }
      Shape Processâ€¢_while_(Check 1âŠ¸âŠ‘)âŸ¨0â€¿1,âŸ¨0âŸ©âŸ©
      ;
    (1=pass_as_arg)âˆ§2=part ?
      l â† 1+ k â† â‰  data util.Digits â†©
      !(Â¯2âŠ‘data)â‰ âŠ‘ d â† â‹ˆÂ¯1âŠ‘data
      Process â† {indexesâ€¿refâ€¿check :
        (0=10000âŠ¸|)â—¶âŸ¨âŠ¢,util.ProgressâŸ©â‰ ref.ref
        âˆ¾ref._apply dd â† util.Digits+Â´ current â† indexesâŠref.ref
        âŸ¨(â‰ ref.ref)|indexes+1+current,ref,ddâˆŠdâŸ©
      }
      Shape â† {(â‰ (1âŠ‘ğ•©).ref)-((1â€¿0âŠ¸â‰¢âˆ¨1â€¿1âŠ¸â‰¢)2âŠ‘ğ•©)â—¶âŸ¨âŠ¢,1âŠ¸+âŸ©k}
      Check â† {
         ğ•¨ ğ•Š 0â€¿0 : 1 ;
         ğ•¨ ğ•Š 0â€¿1 : dataâ‰¢(-k)â†‘ğ•¨.ref ;
         ğ•¨ ğ•Š 1â€¿x : dataâ‰¢Â¯1â†“(-l)â†‘ğ•¨.ref ;
         ğ•¨ ğ•Š âŸ¨0âŸ© : 1 ;
         ğ•¨ ğ•Š âŸ¨1âŸ© : dataâ‰¢(-k)â†‘ğ•¨.ref
      }
      Shape Processâ€¢_while_(CheckÂ´1âŠ¸â†“) âŸ¨0â€¿1,Ref record,âŸ¨0âŸ©âŸ©
    # (2=pass_as_arg)âˆ§2=part ?
    #   "not implemented"!0
    #   ;
  }
}
