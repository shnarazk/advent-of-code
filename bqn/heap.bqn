Parent â† { ! 0 < ğ•©â‹„  Â¯1+2Ã·Ëœ(1+ğ•©)-2|1+ğ•© }   
Children â† { âŸ¨Â¯1+2Ã—Ëœ(1+ğ•©), 2Ã—Ëœ(1+ğ•©)âŸ© }

Heap â† {ğ•¤
  l â† âŸ¨âŸ©
  Dump â‡ { ğ•¤ â‹„ l }
  Push â‡ {
    k â† â‰ l
    l â†© lâˆ¾âŸ¨ğ•©âŸ©
    â€¢Show "last index "â€¿k
    ShiftUp k
  }
  ShiftUp â† {
    ğ•Š 0: @;
    ğ•Š n: {
      m â† Parent n
      âŸ¨p, câŸ© â† âŸ¨mâŠ‘l, nâŠ‘lâŸ©
      â€¢Show "ShiftUp to "â€¿âŸ¨m, p, c, c â‰¤ pâŸ©
      {
        c â‰¤ p ?
          l â†© pË™âŒ¾(nâŠ¸âŠ‘) cË™âŒ¾(mâŠ¸âŠ‘) l
          ShiftUp m;
        @
      } 
    }
  }
  Pop â‡ { ğ•¤
    n â† Â¯1+â‰ l
    âŸ¨v,uâŸ© â† âŸ¨âŠ‘l,nâŠ‘lâŸ©
    l â†© uË™âŒ¾âŠ‘ l
    Shiftdown 0
    l â†© nâ†‘l
    â€¢Show "popped"â€¿l
    v
  }
  ShiftDown â† { ğ•Š m: 
    # âŸ¨n1, n2âŸ© â† âŸ¨Â¯1+2â‹†ğ•©, 2â‹†ğ•©âŸ©
    âŸ¨n1, n2âŸ© â† Children m
    {
      (â‰ l)â‰¤n1 ? â€¢Show " - case0" â‹„ @;
      (â‰ l)=1+n1 ? â€¢Show " - case1" â‹„ âŸ¨p, câŸ© â† âŸ¨mâŠ‘l, n1âŠ‘lâŸ© â‹„ l â†© pË™âŒ¾(n1âŠ¸âŠ‘) cË™âŒ¾(mâŠ¸âŠ‘) l; 
        âŸ¨p, c1, c2âŸ© â† âŸ¨mâŠ‘l, n1âŠ‘l, n2âŠ‘lâŸ©
        {
          c1â‰¤c2 ? l â†© pË™âŒ¾(n1âŠ¸âŠ‘) c1Ë™âŒ¾(mâŠ¸âŠ‘) l â‹„ ShiftDown n1; l â†© pË™âŒ¾(n2âŠ¸âŠ‘) c2Ë™âŒ¾(mâŠ¸âŠ‘) l â‹„ ShiftDown n2
        }
    }
  }
}

h â† Heap @
â€¢Show h.Dump @
h.Push 1
h.Push 10
h.Push 50
h.Push 4
h.Push 20
h.Push 3
h.Push 8
h.Push 2
â€¢Show h.Dump @
! 1 = h.Pop @
â€¢Show h.Dump @
! 2 = h.Pop @
! 3 = h.Pop @
! 4 = h.Pop @
! 8 = h.Pop @
â€¢Show h.Dump @
! 10 = h.Pop @
! 20 = h.Pop @
! 50 = h.Pop @
â€¢Show h.Dump @



