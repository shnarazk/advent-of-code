Solve â‡ {envâ€¿part ğ•Š data :
  utilâ€¿geometry â† â€¢ImportÂ¨"/util.bqn"â€¿"/geometry.bqn"âˆ¾ËœÂ¨<"." env.VarâŒ¾â‹ˆ "BQN_LIB"
  data â†© 'L'=>data
  # floorâ€¿emptyâ€¿occupied â† â†•3
  around â† (4â‰ â†•)9
    {
    1=part ?
      (+Â´Â·â¥Š2âŠ¸=)âŠ‘{nowâ€¿pre :
        âŸ¨{1 ğ•Š 0 : 2 ; 2 ğ•Š m : 4â‰¤m ? 1 ; w ğ•Š m : w}Â¨âŸœ((+Â´2âŠ¸=)Â¨(aroundâŠ¸/Â¨geometry.Neighbor9))now,nowâŸ©
      }â€¢_while_(â‰¢Â´)â‹ˆâŸœ(0Â¨)data ;
    grid â† â†•size â† "size" util.Debug â‰¢data
    w â† 1âŠ‘size
    tran â† âˆ¾âŒœ{Ã—âˆ˜â‰ â—¶âŸ¨âŸ¨âŸ©,1âŠ¸â†‘âŸ©(1=âŠ‘âŸœdata)Â¨âŠ¸/ğ•©}Â¨âŒœ{yâ€¿x :
      âŸ¨
        âŒ½yâ†‘xâŠâ‰1 grid,
        (1+y)â†“xâŠâ‰1 grid,
        âŒ½xâ†‘yâŠâ‰2 grid,
        (1+x)â†“yâŠâ‰2 grid,
        âŒ½(0â€¿0âŠ¸â‰¤âˆ§â—‹(âˆ§Â´)yâ€¿xâŠ¸>)Â¨âŠ¸/âŸ¨0,x-yâŸ©<âŠ¸+0â€¿0â‰grid
        (yâ€¿xâŠ¸<âˆ§â—‹(âˆ§Â´)sizeâŠ¸>)Â¨âŠ¸/âŸ¨0,x-yâŸ©<âŠ¸+0â€¿0â‰grid
        âŒ½(yâ€¿Â¯1âŠ¸<âˆ§â—‹(âˆ§Â´)sizeâŠ¸>)Â¨âŠ¸/âŸ¨0,(x+y)-(w-1)âŸ©<âŠ¸+0â€¿0â‰âŒ½grid
        (0â€¿0âŠ¸â‰¤âˆ§â—‹(âˆ§Â´)yâ€¿wâŠ¸>)Â¨âŠ¸/âŸ¨0,(x+y)-(w-1)âŸ©<âŠ¸+0â€¿0â‰âŒ½grid
      âŸ©
    }Â¨grid
    {
      yâ€¿x â† 0â€¿0
      "n" util.Debug Ã—âˆ˜â‰ â—¶âŸ¨âŸ¨âŸ©,1âŠ¸â†‘âŸ©âŒ½yâ†‘xâŠâ‰1 grid,
      "s" util.Debug Ã—âˆ˜â‰ â—¶âŸ¨âŸ¨âŸ©,1âŠ¸â†‘âŸ©(1+y)â†“xâŠâ‰1 grid,
      "w" util.Debug Ã—âˆ˜â‰ â—¶âŸ¨âŸ¨âŸ©,1âŠ¸â†‘âŸ©âŒ½xâ†‘yâŠâ‰2 grid,
      "e" util.Debug Ã—âˆ˜â‰ â—¶âŸ¨âŸ¨âŸ©,1âŠ¸â†‘âŸ©(1+x)â†“yâŠâ‰2 grid,
      "nw" util.Debug âŒ½(0â€¿0âŠ¸â‰¤âˆ§â—‹(âˆ§Â´)yâ€¿xâŠ¸>)Â¨âŠ¸/âŸ¨0,x-yâŸ©<âŠ¸+0â€¿0â‰grid
      "se" util.Debug (yâ€¿xâŠ¸<âˆ§â—‹(âˆ§Â´)sizeâŠ¸>)Â¨âŠ¸/âŸ¨0,x-yâŸ©<âŠ¸+0â€¿0â‰grid
      "sw" util.Debug âŒ½(yâ€¿Â¯1âŠ¸<âˆ§â—‹(âˆ§Â´)sizeâŠ¸>)Â¨âŠ¸/âŸ¨0,(x+y)-(w-1)âŸ©<âŠ¸+0â€¿0â‰âŒ½grid
      "ne" util.Debug (0â€¿0âŠ¸â‰¤âˆ§â—‹(âˆ§Â´)yâ€¿wâŠ¸>)Â¨âŠ¸/âŸ¨0,(x+y)-(w-1)âŸ©<âŠ¸+0â€¿0â‰âŒ½grid
      (â€¢Fmt yâ€¿x) util.Debug yâ€¿xâŠ‘tran
    }
    (+Â´Â·â¥Š2âŠ¸=)âŠ‘{nowâ€¿pre :
      âŸ¨{1 ğ•Š 0 : 2 ; 2 ğ•Š m : 5â‰¤m ? 1 ; w ğ•Š m : w}Â¨âŸœ((+Â´2âŠ¸=)Â¨(âŠ‘âŸœnow)Â¨tran)now,nowâŸ©
    }â€¢_while_(â‰¢Â´)â‹ˆâŸœ(0Â¨)data
  }
}
