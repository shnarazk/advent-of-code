#!/usr/bin/env cbqn
âŸ¨DataFile,_uncurryâŸ© â† â€¢Import "../lib.bqn"
map â† (â‹ˆËœâˆ˜âˆšâˆ˜â‰ )âŠ¸â¥Šâˆ¾'0'-ËœËœËœ â€¢FLines "data/2022/input-day08.txt" DataFile â€¢args
# We need all four direction map. So the split train found in BQNcrate is not appropriate.
# Sight â† {ğ•ŠâŸ¨w,hâŸ©: w (((hâŠ¸(â‹ˆËœ)Â¨Â¨)âˆ˜âŠ£)âˆ¾((wâŠ¸â‹ˆÂ¨Â¨)âˆ˜âŠ¢))â—‹{ğ•Š p:{p>ğ•©?Â¯1+p-ğ•©;ğ•©}Â¨Â¨p((âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢)â†•1âŠ‘â‰¢map} h}
Sight â† {âŸ¨âŒ½(ğ•¨âŠ¸â‹ˆÂ¨â†•ğ•©),(ğ•¨âŠ¸â‹ˆÂ¨(1+ğ•©)â†“â†•âŠ‘â‰¢map),âŒ½(â‹ˆâŸœğ•©Â¨â†•ğ•¨),(â‹ˆâŸœğ•©Â¨(1+ğ•¨)â†“â†•1âŠ‘â‰¢map)âŸ©}_uncurry
_alldirs_ â† {F _ğ•£_ ğ”¾ ğ•©: ğ”¾Â´{w H dirs: {w F ğ•©}Â¨dirs}âŸœSight ğ•©}

# We need to prove all four directions are invisible pathes. It can't be caused from the
# fact we have a visible path. Because, on the edge, the path is zero length and thus is
# handled as a non-existing path.
Invisible â† {w F xs: âˆ¨Â´{wâ‰¤â—‹(mapË™âŠ¸(âŠ‘Ëœ))ğ•©}Â¨xs}
â€¢Show +Â´Â¬Â¨(Invisible _alldirs_ âˆ§)Â¨â¥Š(â‹ˆâŒœâ—‹â†•)_uncurry â‰¢map

Blocking â† {w F xs: {0=â‰ xs ? 0; i â† âŠ‘âŸ¨1âŸ©âŠËœ{wâ‰¤â—‹(mapË™âŠ¸(âŠ‘Ëœ))ğ•©}Â¨xsâ‹„ i<â‰ xs ? 1+i; â‰ xs}}
â€¢Show âŒˆÂ´(Blocking _alldirs_ Ã—)Â¨â¥Š(â‹ˆâŒœâ—‹â†•)_uncurry â‰¢map
