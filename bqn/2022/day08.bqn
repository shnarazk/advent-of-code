#!/usr/bin/env cbqn
âŸ¨DataFile, ParseIntsâŸ© â† â€¢Import "../lib.bqn"
map â† '0'-ËœËœËœ â€¢FLines "data/2022/input-day08.txt" DataFile â€¢args
map_height â† â‰ map
map_width â† â‰ âŠ‘map
â€¢Show âŸ¨map_height, map_widthâŸ©

At â† { F âŸ¨x, yâŸ© : yâŠ‘xâŠ‘map }
Part1 â† { F âŸ¨x, yâŸ© :
  Sight â† {4â€¿âˆ˜â¥ŠâŸ¨(ğ•¨âŠ¸â‹ˆÂ¨â†•ğ•©),(ğ•¨âŠ¸â‹ˆÂ¨(1+ğ•©)â†“â†•map_height),(â‹ˆâŸœğ•©Â¨â†•ğ•¨),(â‹ˆâŸœğ•©Â¨(1+ğ•¨)â†“â†•map_width)âŸ©}
  Invisible â† {0âŒˆÂ´(ğ•¨â‰¤At)Â¨ğ•©} 
  dirs â† x Sight y
  h â† At âŸ¨x, yâŸ©
  Â¬âˆ§Â´â¥Šh InvisibleÂ¨ dirs
}
â€¢Show +Â´Part1Â¨â¥Š(â†•map_width) â‹ˆâŒœ (â†•map_height)
ScenicScore â† { F âŸ¨x, yâŸ© :
  Sight â† {4â€¿âˆ˜â¥ŠâŸ¨âŒ½(ğ•¨âŠ¸â‹ˆÂ¨â†•ğ•©), (ğ•¨âŠ¸â‹ˆÂ¨(1+ğ•©)â†“â†•map_height), âŒ½(â‹ˆâŸœğ•©Â¨â†•ğ•¨), (â‹ˆâŸœğ•©Â¨(1+ğ•¨)â†“â†•map_width)âŸ©}
  dirs â† x Sight y
  h â† At âŸ¨x, yâŸ©
  Blocking â† {
    0 = â‰ ğ•© ? 0;
    iâ†âŠ‘âŸ¨1âŸ©âŠËœ(hâ‰¤At)Â¨ğ•©
    i<â‰ ğ•© ? 1+i;
    â‰ ğ•©
  }
  Ã—Â´â¥ŠBlockingÂ¨ dirs
}
â€¢Show âŒˆÂ´ScenicScoreÂ¨â¥Š(â†•map_width) â‹ˆâŒœ (â†•map_height)
