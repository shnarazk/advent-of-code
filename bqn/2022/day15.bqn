#!/usr/bin/env cbqn
lib â† â€¢Import "../lib.bqn"
lines â† â€¢Flines "data/2022/input-day15.txt" lib.DataFile âŸ¨âŸ© # â€¢args
data â† (lib.ParseInts{âˆŠâŸœ("-,:"âˆ¾'0'+Â¨â†•10)}âŠ¸/)Â¨ lines
Mdist â† { âŸ¨sx,syâŸ© ğ•Š âŸ¨bx,byâŸ©: (sx-bx)+â—‹|(sy-by) }
Band â† { target_y ğ•Š âŸ¨sx,sy,bx,byâŸ©:
  d â† âŸ¨sx,syâŸ© Mdist âŸ¨bx,byâŸ©
  dx â† d-|target_y-sy
  { 0 â‰¤ dx ? âŸ¨sx-dx,sx+dxâŸ©; âŸ¨âŸ© }
}
F â† { âŸ¨s, eâŸ© ğ•Š âŸ¨total, start, endâŸ© : {s â‰¤ end ? âŸ¨total,start,eâŒˆendâŸ©; âŸ¨total+end-start+1,s,eâŸ©} }
p1 â† 2000000
â€¢Show âˆ˜â€¿1â¥Š b â† âˆ¨(0<â‰ )Â¨âŠ¸/ p1(BandÂ¨) data
on_mark â† â‰ â·{âŸ¨2âŠ‘ğ•©,3âŠ‘ğ•©âŸ©}Â¨((p1âŠ¸=)âˆ˜(3âŠ¸âŠ‘))Â¨âŠ¸/ data
â€¢Show on_mark + {0âŠ‘ğ•©+2âŠ‘ğ•©-1âŠ‘ğ•©+1} âŸ¨0,0âŠ‘Â¯1âŠ‘b,1âŠ‘Â¯1âŠ‘bâŸ©FÂ´b
p2 â† 4000000
sensors â† {âŸ¨sx,sy,bx,byâŸ© â† ğ•© â‹„ âŸ¨sx,sy, âŸ¨sx,syâŸ© Mdist âŸ¨bx,byâŸ©âŸ©}Â¨ data
CheckAround â† {
  âŸ¨sx,sy,dâŸ© ğ•Š 0:
    ss â† {(âŸ¨sx,syâŸ© Mdist âŸ¨0âŠ‘ğ•©,1âŠ‘ğ•©âŸ©)â‰¤1+2âŠ‘ğ•©+d}Â¨âŠ¸/sensors
    Sat â† { ğ•Š c: (0â‰¤0âŠ‘c)âˆ§(0âŠ‘câ‰¤p2)âˆ§(0â‰¤1âŠ‘c)âˆ§(1âŠ‘câ‰¤p2) ? âˆ§Â´{2âŠ‘ğ•©<c Mdist âŸ¨0âŠ‘ğ•©,1âŠ‘ğ•©âŸ©}Â¨ ss; 0 }
    p â† d+1
    l â† â†•p
    k â† (SatÂ¨âŠ¸/{âŸ¨sx+ğ•©,(sy-p)+ğ•©âŸ©}Â¨l)
       âˆ¾(SatÂ¨âŠ¸/{âŸ¨(sx+p)-ğ•©,sy+ğ•©âŸ©}Â¨l)
       âˆ¾(SatÂ¨âŠ¸/{âŸ¨sx-ğ•©,(sy+p)-ğ•©âŸ©}Â¨l)
       âˆ¾(SatÂ¨âŠ¸/{âŸ¨(sx-p)+ğ•©,sy-ğ•©âŸ©}Â¨l)
    {
      kâ‰¡âŸ¨âŸ© ? 0; {(1âŠ‘ğ•©)+(0âŠ‘ğ•©)Ã—p2}âŠ‘k
    };
  ğ•¨ ğ•Š n: n  
}
â€¢Show 0 CheckAroundÂ´ sensors
