#!/usr/bin/env cbqn
lib â† â€¢Import "../lib.bqn"
n â† â‰ data â† âˆ¾lib.parseIntsÂ¨ â€¢Flines "data/2022/input-day20.txt" lib.DataFile â€¢args
âŸ¨next, prevâŸ© â† ((1âŠ¸+)(â‹ˆâ—‹(nâŠ¸|nâŠ¸+))(Â¯1âŠ¸+)) â†•n
Shift â† { ğ•Š i: 
  j â† i
  step â† (Â¯1+n)||v â† iâŠ‘data 
  j â†© {
    1=Ã—v ? {aâ†ğ•©âŠ‘nextâ‹„{a=i?aâŠ‘next;a}}âŸstep j;
    Â¯1=Ã—v? prevâŠ‘Ëœ{aâ†ğ•©âŠ‘prevâ‹„{a=i?aâŠ‘prev;a}}âŸstep j;
    j
  }
  {
    0=step ? @;
    âŸ¨prev_i,next_i,next_jâŸ© â† âŸ¨iâŠ‘prev,iâŠ‘next,jâŠ‘nextâŸ©
    next â†© next_jË™âŒ¾(iâŠ¸âŠ‘) iË™âŒ¾(jâŠ¸âŠ‘) next_iË™âŒ¾(prev_iâŠ¸âŠ‘) next
    prev â†© prev_iË™âŒ¾(next_iâŠ¸âŠ‘) jË™âŒ¾(iâŠ¸âŠ‘) iË™âŒ¾(next_jâŠ¸âŠ‘) prev
  }
}
Trace â† { dataâŠ‘Ëœ{ğ•©âŠ‘next}âŸğ•© âŠ‘data âŠ <0 }
ShiftÂ¨ â†•n
â€¢Show +Â´TraceÂ¨ 1000â€¿2000â€¿3000 

data â†© 811589153Ã—Â¨ data
âŸ¨next, prevâŸ© â†© ((1âŠ¸+)(â‹ˆâ—‹(nâŠ¸|nâŠ¸+))(Â¯1âŠ¸+)) â†•n
n {ShiftÂ¨ â†•ğ•¨}âŸ10 0
â€¢Show +Â´TraceÂ¨ 1000â€¿2000â€¿3000 
