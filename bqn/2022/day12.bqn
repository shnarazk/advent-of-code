#!/usr/bin/env cbqn
lib â† â€¢Import "../lib.bqn"
# âŸ¨lines,status,monkeysâŸ© â‡
lines â† â€¢FLines "data/2022/input-day12.txt" lib.DataFile âŸ¨âŸ© # â€¢args
shape â† (â‰ â‹ˆ(â‰ âŠ‘)) lines
map â† (shapeâŠ¸â¥Š)âˆ˜(Â¯1000âŠ¸+'a'âŠ¸(-Ëœ))âˆ˜âˆ¾ lines
IndexOf â† {âŠ‘(ğ•¨âŠ¸=âŠ‘âŸœğ•©)Â¨âŠ¸/â¥Šâ†•Â·â‰¢ ğ•©}
lib.color.green lib.term.Println start â† (Â¯1000+'S'-'a') IndexOf map
lib.color.green lib.term.Println end â† (Â¯1000+'E'-'a') IndexOf map
â€¢Show startâŠ¸âŠ‘ map
map Â¯1000Ë™âŒ¾(startâŠ¸âŠ‘) â†©
map Â¯1Ë™âŒ¾(endâŠ¸âŠ‘) â†©

MakeNeighbor â† {(âŒ½â‰)âŸ(4-ğ•©)(âˆâŠ¸Â»Ë˜)(âŒ½â‰)âŸğ•© ğ•¨}
Neighbors â† {(ğ•©âŠ¸MakeNeighbor)Â¨ â†•4}
â€¢Show 1âŠ‘reachables â† {(â‰¢map)â¥Š(1+â¥Šmap)â‰¥â¥Šğ•©}Â¨ Neighbors map

m â† 0Ë™âŒ¾(startâŠ¸âŠ‘) map

Debug â† {{â€¢Outâˆ¾{ ğ•Š c: ( {0>c ? 100â€¿100â€¿100 ; 80â€¿200â€¿150} lib.color.RGB 0) lib.color.Out " "}Â¨ğ•©â‹„ âŸ¨âŸ© }Ë˜ğ•©}
Debug m
# Go â† { self ğ•Š dirs:
#   best â† âŒŠÂ´0âŠ¸<Â¨âŠ¸/dirs
#   { âˆ>best ? best; self }
# }

# {k â† 7-7|â‰ linesâ‹„ 0<k ? lines â†© linesâˆ¾âŸ¨âŸ©Ë™Â¨â†•k; @}
# lines â†© âˆ˜â€¿7 â¥Šlines
# Convert â† { ğ•Š noâ€¿itemsâ€¿updateâ€¿testâ€¿thenâ€¿elseâ€¿end:
#   u â† 19â†“update
#   <âŸ¨
#     lib.ParseInt no,
#     0 (+âŸœ(2âŠ¸Ã—))Â´ ("+*" âˆŠ u), # op-code encoded to 1 or 2
#     {2=+Â´("old"âŠ¸(lib.StartsWithËœ))Â¨â†“u ? Â¯1 ; lib.ParseInt u}, # oprand
#     lib.ParseInt test,
#     lib.ParseInt then,
#     lib.ParseInt else,
#   âŸ©
# }
# status â† (<Â·lib.ParseInts 1âŠ¸âŠ‘)Ë˜lines
# inspects â† 0Ë™Â¨â†•â‰  monkeys â† â¥ŠConvertË˜ lines
# limit â† â€¢math.lcmÂ´(3âŠ¸âŠ‘)Â¨monkeys
# Updater â† { noâ€¿opâ€¿argâ€¿testâ€¿thenâ€¿else ğ•Š statusâ€¿insâ€¿part:
#   âŸ¨s,nâŸ© â† âŸ¨status,â‰ noâŠ‘statusâŸ©
#   { ğ•Š item:
#     item â†© partË™â—¶âŸ¨âŒŠ3âŠ¸(Ã·Ëœ),limitâŠ¸|âŸ©op{1 ğ•Š Â¯1: itemÃ—2 ; 1 ğ•Š ğ•©: item+ğ•© ; 2 ğ•Š Â¯1: itemâ‹†2; 2 ğ•Š ğ•©: itemÃ—ğ•©} arg
#     s â†© (âˆ¾âŸœâŸ¨itemâŸ©)âŒ¾(((0=test|item)âŠ‘âŸ¨else,thenâŸ©)âŠ¸âŠ‘) s
#   }Â¨noâŠ‘status
#   âŸ¨âŸ¨âŸ©Ë™âŒ¾(noâŠ¸âŠ‘) s,(nâŠ¸+)âŒ¾(noâŠ¸âŠ‘) ins, partâŸ©
# }
# â€¢Show Ã—Â´2â†‘âˆ¨ 1âŠ‘{ğ•© UpdaterÂ´âŒ½monkeys}âŸ20âŸ¨status,inspects,0âŸ©
# â€¢Show Ã—Â´2â†‘âˆ¨ 1âŠ‘{ğ•© UpdaterÂ´âŒ½monkeys}âŸ10000âŸ¨status,inspects,1âŸ©
