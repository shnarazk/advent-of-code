#!/usr/bin/env cbqn
lib â† â€¢Import "../lib.bqn"
lib.term.Println nest_inâ€¿nest_ut â† @âŠ¸-Â¨ '['â€¿']'
problems â† (2âŠ¸â†‘Ë˜)âˆ˜â€¿3â¥Šâˆ¾âŸœ âŸ¨âŸ¨âŸ©âŸ© â€¢FLines "data/2022/input-day13.txt" lib.DataFile â€¢args
"problem string" lib.Debug âŠ‘problems
Reform â† { ch ğ•Š outâ€¿digits:
  {
    ch=',' ? { 0<â‰ digits ? (outâˆ¾(â€¢BQN digits))â€¿âŸ¨âŸ©; outâ€¿âŸ¨âŸ© };
    ch='[' ? { 0<â‰ digits ? (outâˆ¾âŸ¨â€¢BQN digits,'['âŸ©)â€¿âŸ¨âŸ©; (outâˆ¾('['))â€¿âŸ¨âŸ© };
    ch=']' ? { 0<â‰ digits ? (outâˆ¾âŸ¨â€¢BQN digits,']'âŸ©)â€¿âŸ¨âŸ©; (outâˆ¾(']'))â€¿âŸ¨âŸ© };
    outâ€¿(digitsâˆ¾ch)
  }
}
Enlist â† { token ğ•Š stack:
  {
      # "enlist.token" lib.Debug token "enlist.stack" lib.Debug stack
      token='[' ? stackâˆ¾âŸ¨âŸ¨âŸ©âŸ©;
      (token=']')âˆ§(1=â‰ stack) ? stack;
      token=']' ? last â† Â¯1âŠ‘stackâ‹„ (âˆ¾âŸœâŸ¨lastâŸ©)âŒ¾(Â¯1âŠ¸âŠ‘) Â¯1â†“stack;
      (âˆ¾âŸœâŸ¨tokenâŸ©)âŒ¾(Â¯1âŠ¸âŠ‘) stack
  }
}
problems { âŠ‘ âŸ¨âŸ© EnlistÂ´âŒ½ âŠ‘(âŸ¨âŸ©â€¿âŸ¨âŸ©) ReformÂ´ âŒ½ğ•© }Â¨Ë˜ â†©
"problem listed" lib.Debug âŠ‘problems
InOrder â† {
  wâ€¿x â† âŸ¨âŠ‘ğ•¨, âŠ‘ğ•©âŸ©
  {
    ğ•¨=âŸ¨âŸ© ? 1;
    ğ•©=âŸ¨âŸ© ? Â¯1;

    # If both values are lists,
    (xâˆŠâŸ¨nest_in,nest_utâŸ©)âˆ§(wâˆŠâŸ¨nest_in,nest_utâŸ©) ? {
      x_headâ€¿x_tail â† @
      w_headâ€¿w_tail â† @
      bool â† w_head InOrder x_head
      { 1=|bool ? bool; w_tail InOrder x_tail } 
    };

    # If both values are intergers,
    (Â¬xâˆŠâŸ¨nest_in,nest_utâŸ©)âˆ§(Â¬wâˆŠâŸ¨nest_in,nest_utâŸ©) ? { w<âŠ‘x ? 1; x<âŠ‘ğ•¨ ? Â¯1; ğ•¨ InOrderâ—‹(1âŠ¸â†“) ğ•© };
 
    (xâˆŠâŸ¨nest_in,nest_utâŸ©) ? { w<âŠ‘x ? 1; x<âŠ‘ğ•¨ ? Â¯1; ğ•¨ InOrderâ—‹(1âŠ¸â†“) ğ•© }
  }
}
