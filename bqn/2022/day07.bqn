#!/usr/bin/env cbqn
âŸ¨color,DataFile,ParseInts,StartsWith,SwapâŸ© â† â€¢Import "../lib.bqn"
session â† (âŸ¨âŸ©âŠ¸â‰¢)Â¨âŠ¸/{(âŸ¨âŸ©âŠ¸â‰¢)Â¨âŠ¸/ " "((âŠ¢-ËœÂ¬Ã—Â·+`Â»âŠ¸<)âˆ˜âˆŠËœâŠ”âŠ¢) ğ•©}Â¨"$"((âŠ¢-ËœÂ¬Ã—Â·+`Â»âŠ¸<)âˆ˜âˆŠËœâŠ”âŠ¢)âˆ¾(" "âŠ¸âˆ¾Ëœ)Â¨âˆ˜â€¢FLines "data/2022/input-day07.txt" DataFile â€¢args
dirs â† âŸ¨âŸ©
Traverse â† { io ğ•Š pwd:
  {
    âŸ¨"cd"âŸ©â‰¡io      ? pwd â†© âŸ¨"/"âŸ©;
    âŸ¨"cd",".."âŸ©â‰¡io ? pwd (Â¯1+â‰ )âŠ¸â†‘â†©;
    "cd"â‰¡âŠ‘io       ? pwd (<1âŠ‘io)âŠ¸(âˆ¾Ëœ)â†©;
    "ls"â‰¡âŠ‘io ?
      total â† 0
      {"dir"â‰¢ğ•¨ ? total (â€¢BQN ğ•¨)âŠ¸+â†© â‹„ @; @}Â´Ë˜(2âŠ¸|)Â¨âˆ˜â†•âˆ˜â‰ âŠ¸/2â†•io
      dirs âŸ¨âŸ¨âˆ¾pwd, totalâŸ©âŸ©âŠ¸âˆ¾â†©
  }
  { 0=â‰ pwd ? âŸ¨"/"âŸ©; pwd }
}
âŸ¨âŸ©TraverseÂ´âŒ½session
ComponentsOf â† {(ğ•©Ë™(StartsWithËœ)âŠ‘)Â¨âŠ¸/dirs}
eachDir â† (âŠ‘â‹ˆ(+Â´âˆ˜((1âŠ¸âŠ‘)Â¨)âˆ˜ComponentsOfâŠ‘))Â¨dirs
â€¢Show +Â´(1âŠ¸âŠ‘)Â¨(100000â‰¥1âŠ¸âŠ‘)Â¨âŠ¸/eachDir
â€¢Out color.blue color.Fmt "free"â‹ˆ free â† 70000000-1âŠ¸âŠ‘âŠ‘("/"âŠ¸â‰¡âŠ‘)Â¨âŠ¸/eachDir
â€¢Out color.blue color.Fmt "to be freed"â‹ˆ required â† 30000000 - free
â€¢Show âŠ‘âŠ‘âˆ§(requiredâŠ¸<âŠ‘)Â¨âŠ¸/SwapÂ¨eachDir
