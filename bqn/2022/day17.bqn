Solve â‡ {envâ€¿part ğ•Š data :
  lib â† "." env.VarâŒ¾â‹ˆ "BQN_LIB"
  utilâ€¿âŸ¨HashMapâŸ©â€¿âŸ¨HashSetâŸ© â† â€¢ImportÂ¨"/util.bqn"â€¿"/hashmap.bqn"â€¿"/hashset.bqn"âˆ¾ËœÂ¨<lib
  "shapes" util.Debug shapes â† [
    shape0 â† <[1â€¿1â€¿1â€¿1]
    shape1 â† <[0â€¿1â€¿0,1â€¿1â€¿1,0â€¿1â€¿0]
    shape2 â† <[0â€¿0â€¿1,0â€¿0â€¿1,1â€¿1â€¿1]
    shape3 â† <[âŸ¨1âŸ©,âŸ¨1âŸ©,âŸ¨1âŸ©,âŸ¨1âŸ©]
    shape4 â† <[1â€¿1,1â€¿1]
  ]
  _in_ â† {ğ•¨ ğ”½ _ğ•£_ ğ”¾ ğ•© : diff â† ğ•¨-â—‹(ğ•—âŠ¸âŠ‘)ğ•© â‹„ ((diffâ‰¥âŠ£)âˆ§(diffâ‰¤âŠ¢))Â´ğ•˜}
  ! 0â€¿0 (0)_in_(Â¯2â€¿2) 1â€¿0
  Clashes â† {
    0â€¿(yâ€¿x) ğ•Š âŸ¨âŸ©    : (0â‰¤x)âˆ§(3<x) ;
    1â€¿(yâ€¿x) ğ•Š âŸ¨âŸ©    : (0â‰¤x)âˆ§(4<x) ;
    2â€¿(yâ€¿x) ğ•Š âŸ¨âŸ©    : (0â‰¤x)âˆ§(4<x) ;
    3â€¿(yâ€¿x) ğ•Š âŸ¨âŸ©    : (0â‰¤x)âˆ§(6<x) ;
    4â€¿(yâ€¿x) ğ•Š âŸ¨âŸ©    : (0â‰¤x)âˆ§(5<x) ;
    0â€¿pos1 ğ•Š 0â€¿pos2 : (pos1(0)_in_âŸ¨0,0âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯3,3âŸ©pos2) ;
    0â€¿pos1 ğ•Š 1â€¿pos2 : (pos1(0)_in_âŸ¨Â¯1,Â¯1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯2,3âŸ©pos2)âˆ§(pos1(0)_in_âŸ¨0,2âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,0âŸ©pos2) ;
    0â€¿pos1 ğ•Š 2â€¿pos2 : (pos1(0)_in_âŸ¨0,0âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯2,3âŸ©pos2)âˆ§(pos1(0)_in_âŸ¨Â¯2,Â¯2âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,0âŸ©pos2) ;
    0â€¿pos1 ğ•Š 3â€¿pos2 : (pos1(0)_in_âŸ¨0,3âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,3âŸ©pos2) ;
    0â€¿pos1 ğ•Š 4â€¿pos2 : (pos1(0)_in_âŸ¨0,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯1,3âŸ©pos2) ;
    1â€¿pos1 ğ•Š 1â€¿pos2 :
      âˆ¨Â´âŸ¨
          (pos1(0)_in_âŸ¨Â¯2,2âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,0âŸ©pos2)      # vertical bars
          (pos1(0)_in_âŸ¨0,0âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯2,2âŸ©pos2)      # horizontal bars
          (pos1(0)_in_âŸ¨Â¯1,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯1,1âŸ©pos2)
        âŸ©
      ;
    1â€¿pos1 ğ•Š 2â€¿pos2 :
      âˆ¨Â´âŸ¨
          (pos1(0)_in_âŸ¨Â¯2,2âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯1,Â¯1âŸ©pos2)    # vertical bars
          (pos1(0)_in_âŸ¨1,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯2,2âŸ©pos2)      # horizontal bars
          (pos1(0)_in_âŸ¨Â¯2,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯1,1âŸ©pos2)     # vertical-to-horizontal
          (pos1(0)_in_âŸ¨Â¯1,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯2,0âŸ©pos2)     # horizontal-to-vertical
        âŸ©
      ;
    1â€¿pos1 ğ•Š 3â€¿pos2 :
      âˆ¨Â´âŸ¨
          (pos1(0)_in_âŸ¨Â¯2,3âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨1,1âŸ©pos2)      # vertical bars
          (pos1(0)_in_âŸ¨Â¯1,2âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,2âŸ©pos2)      # horizontal-to-vertical
        âŸ©
      ;
    1â€¿pos1 ğ•Š 4â€¿pos2 :
      âˆ¨Â´âŸ¨
          (pos1(0)_in_âŸ¨Â¯2,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨1,1âŸ©pos2)      # vertical-to-left_bar
          (pos1(0)_in_âŸ¨Â¯2,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,0âŸ©pos2)      # vertical-to-right_bar
          (pos1(0)_in_âŸ¨Â¯1,0âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,2âŸ©pos2)      # horizontal-to-left_bar
          (pos1(0)_in_âŸ¨Â¯1,0âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯1,1âŸ©pos2)     # horizontal-to-right_bar
        âŸ©
       ;
    2â€¿pos1 ğ•Š 2â€¿pos2 :
      âˆ¨Â´âŸ¨
          (pos1(0)_in_âŸ¨Â¯2,2âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,0âŸ©pos2)      # vertical bars
          (pos1(0)_in_âŸ¨0,0âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯2,2âŸ©pos2)      # horizontal bars
          (pos1(0)_in_âŸ¨Â¯2,0âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,2âŸ©pos2)      # vertical-to-horizontal
          (pos1(0)_in_âŸ¨0,2âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯2,0âŸ©pos2)      # horizontal-to-vertical
        âŸ©
      ;
    2â€¿pos1 ğ•Š 3â€¿pos2 :
      âˆ¨Â´âŸ¨
          (pos1(0)_in_âŸ¨Â¯2,3âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨2,2âŸ©pos2)      # vertical bars
          (pos1(0)_in_âŸ¨0,3âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,2âŸ©pos2)       # horizontal-to-vertical
       âŸ©
      ;
    2â€¿pos1 ğ•Š 4â€¿pos2 :
      âˆ¨Â´âŸ¨
          (pos1(0)_in_âŸ¨Â¯2,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨2,2âŸ©pos2)      # vertical-to-left_bar
          (pos1(0)_in_âŸ¨Â¯2,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨1,1âŸ©pos2)      # vertical-to-right_bar
          (pos1(0)_in_âŸ¨0,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,2âŸ©pos2)       # horizontal-to-left_bar
          (pos1(0)_in_âŸ¨0,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯1,1âŸ©pos2)      # horizontal-to-right_bar
        âŸ©
      ;
    3â€¿pos1 ğ•Š 3â€¿pos2 : (pos1(0)_in_âŸ¨Â¯3,3âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨0,0âŸ©pos2) ;
    3â€¿pos1 ğ•Š 4â€¿pos2 : (pos1(0)_in_âŸ¨Â¯3,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯1,0âŸ©pos2) ;
    4â€¿pos1 ğ•Š 4â€¿pos2 : (pos1(0)_in_âŸ¨Â¯1,1âŸ©pos2)âˆ§(pos1(1)_in_âŸ¨Â¯1,1âŸ©pos2) ;
    ğ•¨ ğ•Š ğ•© : ğ•© ğ•Š ğ•¨
  }
  jetPattern â† Â¯1+2Ã—'<'=âŠ‘data
  Force â† 0âŠ¸âˆ¾jetPatternâŠ¸(âŠ‘Ëœ)(â‰ jetPattern)âŠ¸|
  round â† 0
  Simulate â† {nth ğ•Š ground_levelâ€¿record :
    "next rock" util.Debug rock â† shapesâ‰ âŠ¸|nth
    pos â† 1âŠ‘{fallingâ€¿pos:
      pos â†© pos+(Â¬Â·âˆ¨Â´Â·recordâŠ¸(ClashesËœÂ¨)Â·<rockâ‹ˆposâŠ¸+)âŠ¸Ã—Force round    # drifting by wind
      round 1âŠ¸+ â†©
      newpos â† âŸ¨Â¯1,0âŸ©+pos
      {Â¬âˆ¨Â´(<rockâ€¿newpos)ClashesÂ¨record ? 0<âŠ‘newpos ? 1â€¿newpos ; 0â€¿pos}
    }â€¢_while_âŠ‘ 1â€¿âŸ¨4+ground_level,2âŸ©
    âŸ¨âŠ‘pos,recordâˆ¾<posâŸ©
  }
  last â† 5
  # last â† 2022
  âŠ‘0â€¿âŸ¨âŸ¨âŸ©âŸ©SimulateÂ´â†•last
  0
}
