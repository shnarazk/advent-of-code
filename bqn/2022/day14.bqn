#!/usr/bin/env cbqn
lib â† â€¢Import "../lib.bqn"
Inject â† {
 âŸ¨âŸ© ğ•Š m: m;
  s ğ•Š m:
    m {
      begâ€¿end ğ•Š m:
        dxâ€¿dy â† end-beg
        seq â† {
          0<dy ? (â‹ˆâŸœ(0âŠ‘beg))Â¨(1âŠ‘beg)+â†•1+|dy;
          0>dy ? (â‹ˆâŸœ(0âŠ‘end))Â¨(1âŠ‘end)+â†•1+|dy;
          0<dx ? ((1âŠ‘beg)âŠ¸â‹ˆ)Â¨(0âŠ‘beg)+â†•1+|dx;
          0>dx ? ((1âŠ‘end)âŠ¸â‹ˆ)Â¨(0âŠ‘end)+â†•1+|dx;
           ! 0
        }
        (1Ë™Â¨seq)âŒ¾(seqâŠ¸âŠ‘) m
    }Â´â¥Šâ‹ˆË˜2â†•s
}
Run â‡ { part ğ•Š data:
  seg â† lib.ParseIntsÂ¨ data
  âŸ¨xmin,xmaxâŸ©â€¿âŸ¨ymin,ymaxâŸ© â† (âŒŠÂ´â‹ˆ(1âŠ¸+âŒˆÂ´))Â¨(Â¬â‹ˆâŠ¢)â—‹(2âŠ¸|Â¨â†•âˆ˜â‰ )âŠ¸{(â‹ˆâ—‹(/âŸœğ•©))Â´ ğ•¨} âˆ¾seg
  segments â† {(Â¬â‹ˆâŠ¢)â—‹(2âŠ¸|Â¨â†•âˆ˜â‰ )âŠ¸{(â‹ˆÂ¨â—‹(/âŸœğ•©))Â´ ğ•¨} ğ•©}Â¨ seg
  map â† segments (InjectÂ´)Ëœ ymaxâ€¿xmaxâ¥Š 0Ë™â†•xmaxÃ—ymax
  "map shape" lib.Debug â‰¢map
}
