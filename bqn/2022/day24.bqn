Solve â‡ {envâ€¿part ğ•Š data :
  util â† â€¢Import "/util.bqn"âˆ¾Ëœ"." env.VarâŒ¾â‹ˆ "BQN_LIB"
  data â†© âŸ¨â‰ data,âˆ˜âŸ©â¥Šâˆ¾data
  start_positionâ€¿end_position â† 0â€¿Â¯1âŠ nowinds â† ('.'âŠ¸â‰¡dataâŠ¸(âŠ‘Ëœ))Â¨âŠ¸/â¥Šâ†•â‰¢data
  b â† {(ğ•©âŠ¸â‰¡dataâŠ¸(âŠ‘Ëœ))Â¨â†•â‰¢data}'#'    # Blockâ€¿Northâ€¿Eastâ€¿Southâ€¿West
  Reposition â† {ğ•Š ğ•© : Â¯1âŒ½â‰2 Â¯1âŒ½â‰1 (2+â‰¢)âŠ¸â†‘ğ•©}
  nesw â† {1â€¿1âŠ¸â†“Â·(Â¯1+â‰¢data)âŠ¸â†‘Â·(ğ•©âŠ¸â‰¡dataâŠ¸(âŠ‘Ëœ))Â¨â†•â‰¢data}Â¨"^>v<" # Northâ€¿Eastâ€¿Southâ€¿West
  Scene â† {bâŒˆReposition>âŒˆËâŸ¨Â¯1â€¿0,0â€¿1,1â€¿0,0â€¿Â¯1âŸ©(-ğ•©Ã—âŠ£)âŠ¸{yâ€¿xğ•Šm : yâŒ½â‰2 xâŒ½â‰1 m}Â¨nesw}
  Shift â† {(0<ğ•¨)â—¶âŸ¨Â»,Â«âŸ©âŸ(|ğ•¨)ğ•©}
  Adjacent â† {ğ•Š m : >âŒˆË{ğ•Š yâ€¿x : y Shiftâ‰2 x Shiftâ‰1 m}Â¨âŸ¨0â€¿0,Â¯1â€¿0,0â€¿1,1â€¿0,0â€¿Â¯1âŸ©}
  Return â† -Â·Â¬âŠ‘
  startâ€¿end â† {ğ•©âŠ¸â‰¡Â¨â†•â‰¢data}Â¨ start_positionâ€¿end_position
  {
    1=part ?
      WidthFirstSearch â† {âŸ¨1+ğ•¨,ğ•© AdjacentâŠ¸(0âŠ¸<âŠ¸âˆ§âŸœÂ¬)âŸœScene ğ•¨âŸ©}
      Return WidthFirstSearchÂ´â€¢_while_(Â¬Â·end_positionâŠ¸âŠ‘1âŠ¸âŠ‘)1â€¿start ;
    2=part ?
      WidthFirstSearch â† {ğ•Š roundâ€¿statesâ€¿mode:
        next â† states AdjacentâŠ¸(0âŠ¸<âŠ¸âˆ§âŸœÂ¬)âŸœScene round
        goal â† modeâŠ‘âŸ¨@,end,start,endâŸ©
        {goalâ‰¡goalâˆ§next ? next â†© goalÃ—mode 1âŠ¸+ â†© ; @}
        âŸ¨1+round,next,modeâŸ©
      }
      Return WidthFirstSearchâ€¢_while_(4âŠ¸â‰ 2âŠ¸âŠ‘)1â€¿startâ€¿1
  }
}
