Solve â‡ {envâ€¿part ğ•Š data :
  util â† â€¢Import "/util.bqn"âˆ¾Ëœ"." env.VarâŒ¾â‹ˆ "BQN_LIB"
  {
    1=part ?
      "hex" util.Debug 20â†‘data "0123456789ABCDEF"âŠ¸âŠâŒ¾â‹ˆÂ¨âˆ˜âŠ‘ â†©
      "bits" util.Debug âˆ˜â€¿4â¥Š32â†‘data (âˆ¾{âŒ½4â†‘8â€¿1â€¢bit._castâ‹ˆğ•©}Â¨) â†©
      Version â† 3âŠ¸â†‘
      TypeID â† 3âŠ¸â†‘3âŠ¸â†“
      ToNum â† {0{+âŸœ(2âŠ¸Ã—)}Â´âŒ½ğ•©}
      sum â† 0
      num_packets_stack â† âŸ¨0âŸ©

      Traverse â† {ğ•Š start :
        Â¬âˆ§Â´0=startâ†“data ?
        num_packets_stack (1âŠ¸+âŒ¾âŠ‘) â†©
        packet â† startâ†“data
        "start" util.Debug startâ‹ˆ6â†‘packet
        sum + â†© "version" util.Debug version â† ToNum Version packet
        type â† ToNum TypeID packet
        {
          4=type ?
            blocks â† <Ë˜âŒ½â€¿5â¥Š6â†“packet
            len â† 1+(âŠ‘Â¨blocks)âŠ¸âŠâŒ¾â‹ˆ0
            payload â† ToNumâˆ¾1âŠ¸â†“Â¨lenâ†‘blocks
            start+6+5Ã—len
            ;
          7â‰¤â‰ packet ?
            num_packets_stack âŸ¨0âŸ©âŠ¸âˆ¾ â†©
            lengthTypeID â† 6âŠ‘packet
            length_indicator â† ToNum lengthTypeIDâ—¶âŸ¨15âŠ¸â†‘,11âŠ¸â†‘âŸ©7â†“packet
            "operator" util.Debug lengthTypeIDâ€¿length_indicator
            {
              0=lengthTypeID ?
                "subpacket bit limit" util.Debug limit â† length_indicator + 22 + start
                r â† Traverseâ€¢_while_(limitâŠ¸>)22+start
                "stackdown" util.Debug num_packets_stack 1âŠ¸â†“ â†©
                r
              ;
                "subpacket number limit" util.Debug length_indicator
                r â† Traverseâ€¢_while_{ğ•¤ â‹„ length_indicator > âŠ‘num_packets_stack}18+start
                "stackdown" util.Debug num_packets_stack 1âŠ¸â†“ â†©
                r
            }
          ;
            !0
        }
        ;
        S ğ•© : â‰ data
      }
      len â† â‰ data
      {ğ•Š start : Traverse start}â€¢_while_(lenâŠ¸>)0
      sum
    ;
    0
  }
}
