Solve â‡ { envâ€¿part ğ•Š data :
  lib â† â€¢Import "/util.bqn"âˆ¾Ëœ"." env.VarâŒ¾â‹ˆ "BQN_LIB"
  To_dec â† +âŸœ(2âŠ¸Ã—)Â´âˆ˜âŒ½
  data (>'1'âŠ¸=) â†©
  rank2â€¿rank1 â† â‰¢data
  {
    1=part ? Ã—â—‹To_decÂ´â‹ˆâŸœÂ¬(rank2Ã·2)<+Ëdata ;
    2=part ?
      Select â† {
        ğ•¨   ğ•Š âŸ¨candâŸ© : cand ;
        fâ€¿k ğ•Š cands  :
          mask â† kâŠ¸âŠ‘Â¨cands
          target â† (2Ã·Ëœâ‰ cands){ğ•¨=ğ•© ? f ; f ? ğ•¨<ğ•© ; ğ•¨>ğ•©}+Â´mask
          fâ€¿(k+1)ğ•Š(target=mask)/cands
      }
      Ã—â—‹To_decÂ´âŸ¨0â€¿0,1â€¿0âŸ©SelectÂ¨<<Ë˜data
    ; !0
  }
}
