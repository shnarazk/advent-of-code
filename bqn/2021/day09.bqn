Solve ⇐ {env‿part 𝕊 data :
  util ← •Import "/util.bqn"∾˜ "," env.Var⌾⋈ "BQN_LIB"
  map ← (1⊸⌽∞⊸»⍟2)⎉1{𝔽 _𝕣 𝕩 : 𝔽⌾⍉𝔽 𝕩}(2+≢)⊸↑util.ParseInt∘⋈¨>data
  Shift ← (1+×∘⊣)◶⟨∞⊸«,⊢,∞⊸»⟩
  stencil ← (¯2+≢)⊸↑1⌽⎉1 1⌽∾¨´⟨0‿0,1‿0,¯1‿0,0‿1,0‿¯1⟩Shift{y‿x 𝔽 _𝕣 𝕩 : y⊸𝔽⎉1⌾⍉x⊸𝔽⎉1 𝕩}¨<map
  {
    1=part ? +´⥊{∧´<´1(⊑∘↑⋈↓)𝕩 ? 1+⊑𝕩 ; 0}¨stencil ;
    0
  }
}
